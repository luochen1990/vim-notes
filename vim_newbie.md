Vim新手必读
===========

如何提问
--------

### 先定位问题，再解决问题

很多新人在社区问关于vim的问题，人家回答：`:set fencs` 看看。他敲完发现问题没修复就开始抱怨："怎么不起作用啊！"。其实vim的大部分问题都跟具体环境相关，比如你安装了不同插件，自己定义了不同的键映射，或者设置的选项不一样，都可能导致同样的问题发生，但是需要的解决办法是不一样的。就像很多病需要先诊断，后治病，不是什么问题都是随便看一眼，就可以给你开药了的。

那么怎么知道人家给你的命令究竟是用来治病的，还是用来诊断的呢？其实也很容易，首先，如果是一个这样的命令：`:set ai?`（set命令接选项名，以`?`结尾） 或者 `:echo &ai`（echo开头的命令），那么就一定是用来诊断问题的了。当然也可能是`:set fenc`（set接非布尔型取值的选项名）这种。需要注意的是`:set ai`（set接布尔型取值的选项名）这种会直接设置选项值，所以这种是用来治病的而不是诊断问题的。

当然除了这些用来诊断的命令不会立即解决你的问题外，autocmd命令（也常简写为`au`, `auto`）由于是用来给某个事件注册一个回调命令的，所以通常也不会立即执行，而是会在事件被触发的时候才执行。所以别人如果给你一个autocmd命令，那么通常是希望你将它写进vimrc然后重启你的vim程序的。

所以理解帮助你的人的意图，当别人是在帮你诊断问题的时候，配合地输入对方给的命令然后将返回值截图（为什么是截图？因为这可以尽量避免拼写错误，同时暗示对方，你的的确确按他说的做了，而不是自己*YiYin*的一个结果，并且截图也可以避免很多显示上的问题）给对方；当别人给你的是一个autocmd命令并且没有特殊说明的时候，就把它写进vimrc然后重启你的vim程序，再尝试问题是否被解决。这会给双方节省很多时间。

### 当你遇到新的名词...

很多新手在对话中遇到新的名词的时候，会非常本能地问一句："blabla是什么？"。当然从某种程度上来说，这是人之常情，但是这种问题的确会浪费双方很多时间，忍住这种直接问的欲望，先去vim里`:help blabla`一下，大部分情况下，vim的help文档就能回答你的问题，并且很可能给出更多的用法。当然如果vim里没有相应的帮助，有可能是因为对方说的是vim之外的东西，这时你可以去google或者baidu一下。

下面出示一个常见的对话

- A：请问怎么在vim里搜索一个文件夹？
- B：（-。- 你到底是要在一个目录下搜索一个文件名，还是在一个目录下的所有文件里搜索一个词？ 虽然我猜你八成是想问后者，但是对于自己问题都表述不清，还得我再确认一遍的人，回答他的问题太浪费时间精力了，我才懒得理他。。。）
- C：你可以试试grep
- A：grep是什么命令？
- C：你可以去搜一搜
- A：对不起，我刚学vim，可以给个例子么？
- C：搜一下就知道了。。（我说用grep你回答说你刚学vim所以不会grep。。这显然是没有搜过。。）
- A: 不就是给个例子么，有这么难么，有什么好nb的
- C：。。。
- B：（还好我聪明。。。）

这段对话非常典型，而且它甚至不是我虚构的。菜鸟A一开口就犯了表意不明的错误，聪明的B一看到A的提问就躲远了。。。老鸟C心软，想帮帮新人，所以告诉A可以用grep，A却问了"grep是什么?"这么一个问题，于是C不得不说了一句废话让A去搜索，A想以刚学vim为理由装可怜，却根本没有尝试去搜索一下，C自然不想搭理这种人，于是又把前面的废话重复了一遍。。。A却气急败坏了。。。

记住，互联网上互相帮助的礼貌原则是：帮助对方节省时间，而不是光说"请"或"对不起"。一个人如果懒惰，说再多的"请"也无法让人觉得他礼貌。

### 发现愿意帮助你的人

不是每一个接你话的人都是愿意帮助你的人，有些人抛出一堆鄙视的话就是为了贬低别人章显自己；有些人思维广泛联想丰富善于扯出新话题，他们没有恶意，但无法帮助你解决问题；真正愿意帮助你的人会仔细确认你的意思（因为很可能你的表述在他看来可以理解为不同的意思），给你一些诊断命令以便定位问题。你需要仔细辨别，不要在根本没打算帮你的人身上浪费太多时间，当然更不要冷落了那些真心愿意帮助你的人。

关于几个新手应该知道的命令
--------------------------

vim命令既可以在冒号模式里执行，也可以写进vim脚本（通常是vimrc文件及一些以.vim为后缀的文件）里由vim在启动时去某些特定路径里寻找。当然你也可以通过source命令主动加载一个vim脚本。

了解几个简单的vim命令你就可以读懂大部分的vimrc配置，并作一些简单的修改，摆脱只会复制粘贴的尴尬局面，这标志着你将开始逐渐拥有一份自己的vimrc配置，从此你发现vim是如此特别，你会爱上vim。

### help命令

这是vim里的帮助命令，通常用它的简写形式`h`，比如你可以直接在vim的冒号模式里输入`h help`，就可以查看关于help命令的帮助了。

### set命令

这个命令通常用来设置一个vim选项，如`set number`可以开启行号显示。`set list`可以显示一些不可见字符。`set tabstop=4`可以设置将一个缩进符号显示为4个字符宽。有些选项通常需要同时设置，这时可以用一个set命令搞定，如`set noexpandtab nosmarttab tabstop=4 shiftwidth=4 softtabstop=4`，这可以同时设置一系列关于缩进的选项。

set命令也可以用来显示选项的值，这在诊断问题的时候非常有用，如`set list?`，`set autoindent?`，`set tabstop?`（也可以写成`set tabstop`）。

### let命令

let命令用来给变量赋值。你在别人的vim配置里会经常看到let命令出现，因为很多vim插件通过读取某个全局变量的值来设定它的行为模式，包括插件的开启和关闭，这是保证在公共环境下安装vim插件而不影响其他人的好方法，因为只要其他人的vimrc配置里没有定义关于该插件的全局变量，插件就可以选择什么都不做。

关于let命令的具体语法，你可以`:h let`。

### map命令

map命令用来定义按键映射，按键映射简单但强大，可以帮助你减少相当多的重复工作。这几乎是学习vim的初期最具学习性价比的一个命令。

我在这里提到的map命令，其实是一组类似的命令，包括`map`, `noremap`, `imap`, `inoremap`, `nmap`, `nnoremap`... 这些命令都用来定义按键映射，只是作用稍有区别。他们的语法都类似：

```map {lhs} {rhs}```

表示将`{lhs}`按键序列映射到`{rhs}`按键序列

这些命令可以分为两类：不允许递归定义的`*noremap`类和允许递归定义的`*map`类，两类命令的区别就在于，`*noremap`类定义的按键映射仅仅对用户输入的按键序列作映射，不会对其他vim命令的执行产生影响，而`*map`类则会同时对其他vim命令(甚至包括其他map命令)产生的按键序列作映射。

显然`*map`类的映射命令的副作用，对于新手来说是非常不友好的，它很可能会干扰其它脚本及vim插件的工作。事实上，通常我们很少需要用到`*map`类映射命令，而`*noremap`则是可以尽情使用的，所以，如果你对map命令不是十分熟悉，请**从`*noremap`类命令开始**。

常用的几个`*noremap`类命令有：
- `nnoremap` 定义normal模式(普通模式)下的键映射，如`nnoremap j gjzz`
- `inoremap` 定义insert模式(插入模式)下的键映射, 如`inoremap <c-s-tab> <esc>g<s-t>`
- `vnoremap` 定义visual模式(可视模式)下的键映射, 如`vnoremap v <s-v>`

更多的map命令可以参考[这里](http://man.lupaworld.com/content/manage/vi/doc/map.html)

#### 关于那些不能映射的键

在Linux系统中，很多键具有特殊的含义，是不应该在vim里再定义映射的：
- `<c-c>` 向当前进程发送一个终止信号。很多人习惯在windows系统里用这个快捷键复制文本，但是不要把这个习惯带入vim中
- `<c-z>` 向当前进程发送一个挂起信号，当前进程将被挂起到后台。
- `<c-d>` 相当于输入了一个`EOF`(文件结束符)，很多命令行程序通过这个符号判断输入结束。
- `<c-[>` 相当于输入`<esc>`。这是某些情况下输入`<esc>`的唯一方式。
- `<c-h>` 相当于输入`<backspace>`，这是某些情况下输入`<backspace>`的唯一方式。


